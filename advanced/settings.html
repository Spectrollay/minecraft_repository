<!--
  ~ Copyright © 2020. Spectrollay
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy
  ~ of this software and associated documentation files (the "Software"), to deal
  ~ in the Software without restriction, including without limitation the rights
  ~ to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  ~ copies of the Software, and to permit persons to whom the Software is
  ~ furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in
  ~ all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  ~ IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  ~ FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  ~ AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  ~ LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  ~ SOFTWARE.
  -->

<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="/minecraft_repository/stylesheet/loading_mask.css" rel="stylesheet">
    <link href="/minecraft_repository/images/Settings.png" rel="icon">
    <!--<style>-->
    <!--    -->
    <!--</style>-->
    <title>设置</title>
</head>

<body>
<div class="loading_mask" id="loading_mask">
    <div>
        <div class="spinner"><img alt="" id="spinner_img" src="/minecraft_repository/images/Loading_white.gif"/></div>
        <div class="spinner">
            <div class="spinner"><span class="spinner_text">载入中</span></div>
        </div>
        <noscript>
            <style>
                #spinner_img, .spinner_text {
                    display: none;
                }
            </style>
            <div class="spinner"><img alt="" id="spinner_img_error" src="/minecraft_repository/images/ErrorMessage.png"/></div>
            <div class="spinner">
                <div class="spinner"><span class="spinner_text_error">页面无法加载: 当前环境不支持或已禁用脚本.<br>请更换支持脚本的环境或在设置中允许脚本后访问本站.</span></div>
            </div>
        </noscript>
    </div>
</div>
<header>
    <div class="header_item header_item_left" id="back" onclick="clickedBack();">
        <img alt="" class="back_icon" id="back_icon" src=""/>
    </div>
    <div class="header_logo">
        <img alt="Title Icon" class="title_icon" src="/minecraft_repository/images/Settings.png"/>
        <span class="header_title">Settings</span>
    </div>
    <div class="header_item header_item_right header_right_blank"></div>
</header>
<scroll-view>
    <scroll-container class="main_scroll_container">
        <main class="scroll_container" id="main">
            <div class="main_title">
                <div class="main_title_span">设置</div>
            </div>
            <!--  TODO: 移除时一并移除相应样式  -->
            <div class="main preview_block">
                <div class="preview_title">抢先体验设置页面!</div>
                <div class="preview_detail">我们正在开发版本库的设置页面.</div>
                <div class="preview_detail">你认为我们有什么可以改进的地方吗?</div>
                <div class="preview_detail">请注意: 开发仍在进行中,可能会缺失部分功能.</div>
                <div class="btn_group">
                    <custom-button data="default|normal|small|preview_btn1|false||" js="toUpdatelog();" text=""></custom-button>
                    <custom-button data="default|green|small|preview_btn2|false||" js="toRepo();" text=""></custom-button>
                </div>
            </div>
            <div class="main_block setting_block" id="quit_test">
                <div class="setting_title_content">退出测试</div>
                <div class="setting_control_right">
                    <custom-button data="setting|red|||false||" js="leaveTest();" text="离开"></custom-button>
                </div>
            </div>
            <div class="setting_title">无障碍</div>
            <div class="main_block setting_block">
                <div class="setting_title_content">使用文本转语音</div>
                <div class="setting_control_right">
                    <custom-switch active="off" id="use_tts" status="disabled"></custom-switch>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">文本转语音音量</div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">高对比度UI</div>
                <div class="setting_control_right">
                    <custom-switch active="off" id="high_contrast_ui" status="disabled"></custom-switch>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">通知持续时间</div>
            </div>
            <div class="setting_title">外观</div>
            <div class="main_block setting_block">
                <div class="setting_title_content">主题</div>
                <div class="setting_control_right">
                    <div class="dropdown_container">
                        <custom-dropdown data-option='["Vanilla", "Lite", "OreUI"]' data-selected="3" id="theme_selection" status="disabled" unselected-text=""></custom-dropdown>
                    </div>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_block_content">
                    <div class="setting_block_title flex">
                        <div class="setting_title_content">暗黑模式</div>
                        <div class="setting_control_right">
                            <custom-switch active="off" id="dark_mode" status="disabled"></custom-switch>
                        </div>
                    </div>
                    <div class="setting_block_description">OreUI主题下无法启用</div>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">实验性新UI</div>
                <div class="setting_control_right">
                    <custom-switch active="off" id="exp_new_ui" status="enabled"></custom-switch>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">UI标度</div>
            </div>
            <div class="setting_title">行为</div>
            <div class="main_block setting_block" id="use_all_tip">
                <div class="setting_block_content">
                    <div class="setting_block_title flex">
                        <div class="setting_title_content">完整提示列表</div>
                        <div class="setting_control_right">
                            <custom-switch active="off" id="all_tip" status="enabled"></custom-switch>
                        </div>
                    </div>
                    <div class="setting_block_description">在开发仓库可以查看完整的主页提示</div>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">访问受限弹窗</div>
                <div class="setting_control_right">
                    <custom-switch active="on" id="limited_access_modal" status="disabled"></custom-switch>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">加载指示器</div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">滚动条</div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">页面过渡动画</div>
            </div>
            <div class="setting_title">通知</div>
            <div class="main_block setting_block">
                Banner通知
            </div>
            <div class="main_block setting_block">
                Modal通知
            </div>
            <div class="main_block setting_block">
                Pop通知
            </div>
            <div class="setting_title">声音</div>
            <div class="main_block setting_block">
                启用音效
            </div>
            <div class="main_block setting_block">
                音效音量
            </div>
            <div class="setting_title">其他</div>
            <div class="main_block setting_block">
                <div class="setting_title_content">语言</div>
                <div class="setting_control_right">
                    <div class="dropdown_container">
                        <custom-dropdown data-option='["简体中文", "English"]' data-selected="1" id="language_selection" status="disabled" unselected-text=""></custom-dropdown>
                    </div>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_block_content">
                    <div class="setting_block_title flex">
                        <div class="setting_title_content">实验性内容</div>
                        <div class="setting_control_right">
                            <custom-button data="setting|normal|||false||" js="flagsPage();" text="查看"></custom-button>
                        </div>
                    </div>
                    <divider class="new_flags_page"></divider>
                    <div class="setting_block_title flex new_flags_page">
                        <div class="setting_title_content">新的实验性内容页面</div>
                        <div class="setting_control_right">
                            <custom-switch active="off" id="new_flags_page" status="enabled"></custom-switch>
                        </div>
                    </div>
                </div>
            </div>
            <div class="main_block setting_block exp_envi_guide">
                <div class="setting_title_content">环境指南<span class="tag yellow_tag exp_tag">实验性</span></div>
                <div class="setting_control_right">
                    <custom-button data="setting|normal|||false||" js="enviPage();" text="阅读"></custom-button>
                </div>
            </div>
            <div class="setting_title">高级</div>
            <div class="main_block setting_block">
                <div class="setting_title_content">清除存储数据</div>
                <div class="setting_control_right">
                    <custom-button data="setting|red|||false||" js="showModal('clear_storage_warning');" text="清除"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">重载容器环境</div>
                <div class="setting_control_right">
                    <custom-button data="setting|red|||false||" js="showModal('reload_page_warning');" text="重载"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block debug_mode">
                <div class="setting_title_content">加载调试程序</div>
                <div class="setting_control_right">
                    <custom-button data="setting|red|||false||" js="jumpToPage('/minecraft_repository/advanced/debug.html');" text="调试"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block clear_all">
                <div class="setting_title_content red_stroke">重置全部内容</div>
                <div class="setting_control_right">
                    <custom-button data="setting|red|||false||" js="showModal('clear_all_warning');" text="重置"></custom-button>
                </div>
            </div>
            <div class="setting_title">关于</div>
            <div class="main_block setting_block">
                <div class="setting_title_content">星月Minecraft版本库</div>
                <div class="setting_control_right setting_control_right_large">
                    <custom-button data="setting|normal|||false||" js="repoPage();" text="仓库"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block" id="version_block">
                <div class="setting_title_content">版本: <span id="setting_version"></span></div>
                <div class="setting_control_right setting_control_right_large">
                    <custom-button data="setting|normal|||false||" js="showModal('version_info_modal');" text="详情"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block" id="developer_block">
                <div class="setting_title_content">开发者: Spectrollay</div>
                <div class="setting_control_right">
                    <custom-button data="setting|normal|||false||" js="openLink('https://github.com/Spectrollay');" text="瞅一瞅"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">其他项目</div>
                <div class="setting_control_down">
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">用户协议</div>
                <div class="setting_control_right">
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">开源协议</div>
                <div class="setting_control_right">
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">联系我们</div>
                <div class="setting_control_right">
                    <custom-button data="setting|normal|||false||" js="jumpToPage('/minecraft_repository/default/error_not-found.html');" text="打开"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">捐赠支持</div>
                <div class="setting_control_right">
                    <custom-button data="setting|normal|||false||" js="showModal('donate_modal');" text="支持"></custom-button>
                </div>
            </div>
            <div class="main_block setting_block">
                <div class="setting_title_content">特别鸣谢</div>
                <div class="setting_control_right">
                    <custom-button data="setting|normal|||false||" js="showModal('acknowledgments_modal');" text="查看"></custom-button>
                </div>
            </div>
            <div id="the_end"></div>
        </main>
    </scroll-container>
    <custom-scrollbar class="main_custom_scrollbar">
        <custom-scrollbar-track></custom-scrollbar-track>
        <custom-scrollbar-thumb></custom-scrollbar-thumb>
    </custom-scrollbar>
</scroll-view>


<!--遮罩-->
<!--除了顶栏-->
<div class="overlay_main" id="overlay_main" onclick="clickedOverlay();"></div>

<!--版本信息弹窗-->
<div class="overlay" id="overlay_version_info_modal"></div>
<modal_area id="version_info_modal">
    <modal>
        <modal_title_area>
            <modal_title>详情</modal_title>
            <modal_close_btn class="close_btn" onclick="hideModal(this);">
                <img alt="" class="modal_close_btn_img" src=""/>
            </modal_close_btn>
        </modal_title_area>
        <modal_content>
            <div id="setting_version_detail"></div>
        </modal_content>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|green|||false||" js="hideModal(this);" text="好的"></custom-button>
                    <custom-button data="modal|normal|||false||" js="copyText(document.getElementById('project_hash').innerText);hideModal(this);" text="复制校验码"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

<!--清除数据警告弹窗-->
<div class="overlay" id="overlay_clear_storage_warning"></div>
<modal_area id="clear_storage_warning">
    <modal>
        <modal_title_area>
            <modal_title class="red_stroke">清除存储数据</modal_title>
        </modal_title_area>
        <modal_content>
            <p>清除存储数据为危险功能!<br>这会导致本站的本地存储数据(云控信息/个性化内容/保存的数据等)全部清空且永远无法恢复!<br>非必要请不要运行此功能!</p>
        </modal_content>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|normal|||false||" js="hideModal(this);" text="取消"></custom-button>
                    <custom-button data="modal|red|||false||" js="hideModal(this);clearStorage();" text="我知道我在做什么!"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

<!--重载页面警告弹窗-->
<div class="overlay" id="overlay_reload_page_warning"></div>
<modal_area id="reload_page_warning">
    <modal>
        <modal_title_area>
            <modal_title>重载容器环境</modal_title>
        </modal_title_area>
        <modal_content>
            <p>建议在每次更新版本后运行此功能.<br>这可能可以解决网站的加载异常问题.<br>此功能不会影响你的本地数据.</p>
        </modal_content>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|normal|||false||" js="hideModal(this);" text="取消"></custom-button>
                    <custom-button data="modal|normal|||false||" js="hideModal(this);reloadPage();" text="继续"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

<!--重置警告弹窗-->
<div class="overlay" id="overlay_clear_all_warning"></div>
<modal_area id="clear_all_warning">
    <modal>
        <modal_title_area>
            <modal_title class="red_stroke">重置全部内容</modal_title>
        </modal_title_area>
        <modal_content>
            <p>重置全部内容为极度危险功能!<br>这会导致本域名(spectrollay.github.io)下所有站点的本地存储数据全部清除且永远无法恢复!<br>请不要运行此功能除非你已了解该功能的确切用法并知晓这可能会造成的后果!</p>
        </modal_content>
        <modal_textfield_area>
            <modal_textfield_title>请输入"我知道我在做什么"以继续</modal_textfield_title>
            <div class="text_field_container do_not_save" id="check_input">
                <text-field hint="在此输入.." single-line="true" status="enabled" type="all"></text-field>
            </div>
        </modal_textfield_area>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|green|||false||" js="hideModal(this);document.getElementById('check_input').querySelector('text-field').resetValue();" text="取消"></custom-button>
                    <custom-button data="modal|disabled||check_continue|false||" js="" text="重置"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

<!--捐赠支持弹窗-->
<div class="overlay" id="overlay_donate_modal"></div>
<modal_area id="donate_modal">
    <modal>
        <modal_title_area>
            <modal_title>捐赠支持</modal_title>
            <modal_close_btn class="close_btn" onclick="hideModal(this);">
                <img alt="" class="modal_close_btn_img" src=""/>
            </modal_close_btn>
        </modal_title_area>
        <modal_content id="donate_message">
        </modal_content>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|normal|||false||" js="hideModal(this);jumpToPage('/minecraft_repository/about/donate.html');" text="打赏"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

<!--特别鸣谢弹窗-->
<div class="overlay" id="overlay_acknowledgments_modal"></div>
<modal_area id="acknowledgments_modal">
    <modal>
        <modal_title_area>
            <modal_title>特别鸣谢</modal_title>
            <modal_close_btn class="close_btn" onclick="hideModal(this);">
                <img alt="" class="modal_close_btn_img" src=""/>
            </modal_close_btn>
        </modal_title_area>
        <modal_content id="acknowledgments">
        </modal_content>
        <modal_button_area>
            <modal_button_group>
                <modal_button_list>
                    <custom-button data="modal|normal|||false||" js="hideModal(this);" text="关闭"></custom-button>
                </modal_button_list>
            </modal_button_group>
        </modal_button_area>
    </modal>
</modal_area>

</body>

<script src="/minecraft_repository/javascript/loading.js"></script>
<script src="/minecraft_repository/javascript/public_script.js"></script>
<script>
    rootPath = '/' + (window.location.pathname.split('/').filter(Boolean).length > 0 ? window.location.pathname.split('/').filter(Boolean)[0] + '/' : '');
    if (rootPath.includes('_test')) {
        document.getElementById('quit_test').style.display = "flex";
        document.getElementById('use_all_tip').style.display = "flex";
    }

    // 新的实验性内容页面  TODO: 在旧的实验性内容页面被移除时时删除
    const newFlagsPageElement = document.getElementsByClassName('new_flags_page');
    if (!rootPath.includes('_test')) {
        for (let i = 0; i < newFlagsPageElement.length; i++) {
            newFlagsPageElement[i].style.display = 'none';
        }
    }

    switchValues = JSON.parse(localStorage.getItem('(/minecraft_repository/)switch_value')) || {};

    // 环境指南页面  TODO: 在移除环境指南页面实验性内容时移除相关代码
    let expEnviGuideState = switchValues['experimental_envi_guide'] || 'off';
    let envi_guide_elements = document.querySelectorAll('.exp_envi_guide');

    if (expEnviGuideState === 'on') {
        envi_guide_elements.forEach(envi_guide_element => {
            envi_guide_element.style.display = 'flex';
        })
    } else {
        envi_guide_elements.forEach(envi_guide_element => {
            envi_guide_element.style.display = 'none';
        })
    }
</script>

<style>
    /* TODO: 在移除环境指南页面实验性内容时移除该样式 */
    .exp_envi_guide {
        display: none;
    }

    #quit_test, #show_all_tip {
        display: none;
    }

    table, th, tr, td {
        border: none;
        height: auto;
        text-align: left;
        width: auto;
    }

    table {
        margin: 10px 0;
    }

    tr {
        height: 25px;
    }

    td {
        width: 120px;
    }

    .left_td {
        text-align: right;
        padding-right: 10px;
    }

    .right_td {
        padding-left: 10px;
    }

    #use_all_tip {
        display: none;
    }

    #setting_version_detail {
        justify-items: center;
    }

    .switch_content {
        display: flex;
        justify-content: center;
    }

    .debug_mode, .clear_all {
        display: none;
    }
</style>

</html>
